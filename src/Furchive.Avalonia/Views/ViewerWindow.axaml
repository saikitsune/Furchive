<Window xmlns="https://github.com/avaloniaui" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:beh="using:Furchive.Avalonia.Behaviors" x:Class="Furchive.Avalonia.Views.ViewerWindow" Width="1100" Height="800" MinWidth="600" MinHeight="400" Title="Viewer" Icon="avares://Furchive/Assets/icon.ico">
    <Grid RowDefinitions="Auto,Auto,*">
        <!-- Control bar -->
        <DockPanel Grid.Row="0" Background="#2b2b2b" Height="40" LastChildFill="False">
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="10,0" VerticalAlignment="Center">
                <Button x:Name="ZoomButton" Content="Zoom" Click="OnZoomButtonClick" />
                <TextBlock Text="Size:" Margin="16,0,4,0" VerticalAlignment="Center" />
                <ComboBox x:Name="SizeModeCombo" Width="110" SelectedIndex="0" SelectionChanged="OnSizeModeSelectionChanged">
                    <ComboBoxItem Content="Fit" />
                    <ComboBoxItem Content="Original" />
                </ComboBox>
                <Button x:Name="PrevButton" Content="Prev" Margin="24,0,0,0" IsVisible="False" Click="OnPrevClick" />
                <Button x:Name="NextButton" Content="Next" IsVisible="False" Click="OnNextClick" />
                <TextBlock x:Name="IndexLabel" Text="" Margin="12,0,0,0" VerticalAlignment="Center" IsVisible="False" />
                <TextBlock x:Name="PoolNameLabel" Text="" Margin="24,0,0,0" VerticalAlignment="Center" IsVisible="False" />
            </StackPanel>
        </DockPanel>
        <!-- Zoom slider panel (collapsible) -->
        <Border x:Name="ZoomPanel" Grid.Row="1" Background="#333" Padding="10" IsVisible="False">
            <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                <TextBlock Text="Zoom:" VerticalAlignment="Center" />
                <Slider x:Name="ZoomSlider" Minimum="10" Maximum="1000" Value="100" Width="300" ValueChanged="OnZoomSliderChanged" />
                <TextBlock x:Name="ZoomPercent" Text="100%" VerticalAlignment="Center" />
            </StackPanel>
        </Border>
        <!-- Image viewport with wheel-based zoom anchoring -->
        <Border Grid.Row="2" Background="#202020" ClipToBounds="True">
            <!-- Plain host (no scrollbars). We handle zoom + translation manually. -->
            <Grid x:Name="ViewportHost" PointerWheelChanged="OnViewportWheel" PointerPressed="OnViewportPointerPressed" PointerReleased="OnViewportPointerReleased" PointerMoved="OnViewportPointerMoved" Background="#101010">
                <Image x:Name="ImageElement" Stretch="Uniform" beh:RemoteImage.SourceUri="" RenderTransformOrigin="0,0" HorizontalAlignment="Center" VerticalAlignment="Center" />
                <Grid x:Name="VideoHost" IsVisible="False" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="#101010" />
                <!-- Debug overlay rectangle (toggle IsVisible in code if needed) -->
                <Border x:Name="ViewportDebugBorder" BorderBrush="#55FF0000" BorderThickness="1" IsHitTestVisible="False" IsVisible="False" />
            </Grid>
        </Border>
    </Grid>
</Window>
